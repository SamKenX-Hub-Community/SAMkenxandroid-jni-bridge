build_for_android:
  name: Build JNIBridge
  agent:
    type: Unity::VM::osx
    image: build-system/unity-extra-macos-10.13-katana:v0.3.6-621005
    flavor: b1.xlarge
  commands:
    - ./bee build:android:zip
  artifacts:
    artifacts:
      paths:
        - build/builds.zip

test_on_osx:
  name: Test on OSX
  agent:
    type: Unity::VM::osx
    image: build-system/unity-extra-macos-10.13-katana:v0.3.6-621005
    flavor: b1.xlarge
  commands:
    - perl build.pl
    - Android_SDK_ROOT=~/android-sdk_auto ./bee build:osx:test
    - ./build/osx/test

test_trigger:
  name: Tests Trigger
  agent:
    type: Unity::VM::osx
    image: build-system/unity-extra-macos-10.13-katana:v0.3.6-621005
    flavor: b1.xlarge
  commands:
    - true
  triggers:
    branches:
      only:
        - "/.*/"
  dependencies:
    - .yamato/build.yml#test_on_osx
